<app-header></app-header>

<div class="container mt-5">
  <div class="card shadow">
    <div class="card-body">
      <h4 class="card-title text-center mb-4">Create New Farmer Offer</h4>

      <form [formGroup]="farmerOfferForm" (ngSubmit)="onSubmit()">
        
        <!-- Full Name -->
        <div class="mb-3">
          <label class="form-label">Full Name</label>
          <input type="text" formControlName="fullName" class="form-control" placeholder="Enter your full name" />
          <div class="text-danger" *ngIf="f['fullName'].touched && f['fullName'].invalid">
            <small *ngIf="f['fullName'].errors?.['required']">Full name is required.</small>
            <small *ngIf="f['fullName'].errors?.['minlength']">Full name must be at least 2 characters.</small>
            <small *ngIf="f['fullName'].errors?.['maxlength']">Full name cannot exceed 100 characters.</small>
          </div>
        </div>

        <!-- Age -->
        <div class="mb-3">
          <label class="form-label">Age (Optional)</label>
          <input type="number" formControlName="age" class="form-control" placeholder="e.g. 35" min="18" max="100" />
          <div class="text-danger" *ngIf="f['age'].touched && f['age'].invalid">
            <small *ngIf="f['age'].errors?.['min']">Age must be at least 18.</small>
            <small *ngIf="f['age'].errors?.['max']">Age cannot exceed 100.</small>
          </div>
        </div>

        <!-- Contact Number -->
        <div class="mb-3">
          <label class="form-label">Contact Number</label>
          <input type="tel" formControlName="contactNumber" class="form-control" placeholder="e.g. +962791234567" />
          <div class="text-danger" *ngIf="f['contactNumber'].touched && f['contactNumber'].invalid">
            <small *ngIf="f['contactNumber'].errors?.['required']">Contact number is required.</small>
            <small *ngIf="f['contactNumber'].errors?.['pattern']">Please enter a valid phone number.</small>
          </div>
        </div>

        <!-- Email Address -->
        <div class="mb-3">
          <label class="form-label">Email Address</label>
          <input type="email" formControlName="emailAddress" class="form-control" placeholder="Enter your email" />
          <div class="text-danger" *ngIf="f['emailAddress'].touched && f['emailAddress'].invalid">
            <small *ngIf="f['emailAddress'].errors?.['required']">Email address is required.</small>
            <small *ngIf="f['emailAddress'].errors?.['email']">Please enter a valid email address.</small>
            <small *ngIf="f['emailAddress'].errors?.['maxlength']">Email cannot exceed 100 characters.</small>
          </div>
        </div>

        <!-- Current Address -->
        <div class="mb-3">
          <label class="form-label">Current Address</label>
          <input type="text" formControlName="currentAddress" class="form-control" placeholder="Enter your current address" />
          <div class="text-danger" *ngIf="f['currentAddress'].touched && f['currentAddress'].invalid">
            <small *ngIf="f['currentAddress'].errors?.['required']">Current address is required.</small>
            <small *ngIf="f['currentAddress'].errors?.['minlength']">Address must be at least 5 characters.</small>
            <small *ngIf="f['currentAddress'].errors?.['maxlength']">Address cannot exceed 200 characters.</small>
          </div>
        </div>

        <!-- Description -->
        <div class="mb-3">
          <label class="form-label">Description</label>
          <textarea formControlName="description" class="form-control" rows="4" placeholder="Describe your farming experience, skills, and what you're looking for"></textarea>
          <div class="text-danger" *ngIf="f['description'].touched && f['description'].invalid">
            <small *ngIf="f['description'].errors?.['required']">Description is required.</small>
            <small *ngIf="f['description'].errors?.['minlength']">Description must be at least 10 characters.</small>
            <small *ngIf="f['description'].errors?.['maxlength']">Description cannot exceed 1000 characters.</small>
          </div>
        </div>

        <!-- Images -->
        <div class="mb-3">
          <label class="form-label">Profile Photos</label>
          <div class="image-upload-container">
            <div class="image-upload-box" (click)="triggerFileInput()">
              <div class="upload-icon">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="size-6">
                  <path fill-rule="evenodd" d="M1.5 6a2.25 2.25 0 0 1 2.25-2.25h16.5A2.25 2.25 0 0 1 22.5 6v12a2.25 2.25 0 0 1-2.25 2.25H3.75A2.25 2.25 0 0 1 1.5 18V6ZM3 16.06V18c0 .414.336.75.75.75h16.5A.75.75 0 0 0 21 18v-1.94l-2.69-2.689a1.5 1.5 0 0 0-2.12 0l-.88.879.97.97a.75.75 0 1 1-1.06 1.06l-5.16-5.159a1.5 1.5 0 0 0-2.12 0L3 16.061Zm10.125-7.81a1.125 1.125 0 1 1 2.25 0 1.125 1.125 0 0 1-2.25 0Z" clip-rule="evenodd" />
                </svg>
              </div>
              <div class="upload-text">
                <p class="upload-title">Click to select images</p>
                <p class="upload-subtitle">Recommended: 2-4 images (multiple selection allowed)</p>
              </div>
            </div>
            <input 
              #fileInput
              type="file" 
              multiple 
              accept="image/*" 
              (change)="onFileSelected($event)" 
              class="file-input-hidden" 
            />
          </div>
        </div>

        <!-- Preview -->
        <div class="mb-3" *ngIf="previewUrls.length > 0">
          <label class="form-label">Selected Images</label>
          <div class="image-preview-container">
            <div *ngFor="let url of previewUrls; let i = index" class="image-preview-item">
              <img [src]="url" class="preview-image" />
              <button type="button" class="remove-image-btn" (click)="removeImage(i)" title="Remove image">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="size-5">
                  <path fill-rule="evenodd" d="M12 2.25c-5.385 0-9.75 4.365-9.75 9.75s4.365 9.75 9.75 9.75 9.75-4.365 9.75-9.75S17.385 2.25 12 2.25zm-1.72 6.97a.75.75 0 10-1.06 1.06L10.94 12l-1.72 1.72a.75.75 0 101.06 1.06L12 13.06l1.72 1.72a.75.75 0 101.06-1.06L13.06 12l1.72-1.72a.75.75 0 10-1.06-1.06L12 10.94l-1.72-1.72z" clip-rule="evenodd" />
                </svg>
              </button>
            </div>
          </div>
        </div>

        <!-- Submit -->
        <button type="submit" class="btn btn-success w-100" [disabled]="isSubmitting || farmerOfferForm.invalid">
          {{ isSubmitting ? 'Publishing...' : 'Publish Farmer Offer' }}
        </button>
      </form>
    </div>
  </div>
</div>

<app-footer></app-footer>